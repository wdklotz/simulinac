# Copyright 2015 Wolf-Dieter Klotz <wdklotz@gmail.com>
# This file is part of the SIMULINAC code

# SIMULINAC is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# any later version.

# SIMULINAC is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with SIMULINAC.  If not, see <http://www.gnu.org/licenses/>.
#
# Input file for FODO linac simulator
# Input file follows YAML syntax (http:\\http://yaml.org/)
#
# Note:
#   Repeated nodes are initially denoted by an ampersand ( & )
#   and thereafter referenced with an asterisk ( * ).
##...........................................................................................
## run configuration
##...........................................................................................
flags:                              ## run configuration
    - accON:        True            # accelleration on/off flag
    - periodic:     False            # treat lattice as periodic cell sequence(else as transfer line)
    - verbose:      0               # print flag (0 = minimal print), try 0,1,2,3
##...........................................................................................
## INPUT parameter definitions
##...........................................................................................
parameters:                           ## parameter definitions
    - Tkin:                 5.0         # [MeV] energy @ entrance (injection)
    - ql0:          &p02    0.10      # [m] quad-length
    - ql:           &p03    0.05      # [m] 1/2 quad-length
    - emity_i:              1.E-6     # [m*rad] transverse emittance @ entrance x
    - emitx_i:              1.E-6     # [m*rad] transverse emittance @ entrance y
    # - betax_i:              2.350     # [m] twiss beta @ entrance x
    - betax_i:              7.084     # [m] twiss beta @ entrance x (tuned with RF-2x20)
    # - betay_i:              0.416     # [m] twiss beta @ entrance y
    - betay_i:              1.902     # [m] twiss beta @ entrance y (tuned with RF-2x20)
    - alfax_i:              0.0       # [-] twiss alpha x @ entrance
    - alfay_i:              0.0       # [-] twiss alpha y @ entrance
    - Dp/p:                 0.1       # [%] relative impulse Dp/p @ entrance
    - Dz:                   1.e-3     # [m] longitudinal displacement Dz @ entrance
    - frequency:    &p01    816.E+6   # [Hz] frequency f0
    - Ez:           &p05    1.00      # [MV/m] electric field strength
    - phi_sync:     &p06   -20.       # [deg] synchronous phase
    - gap:          &p07    0.020     # [m] (accelerating) gap size
    - cav_len:      &p08    0.020     # [m] cavity length
    - windings:             30        # [-] quad-coil windings

    # - B_grad:       &p04    2.86      # [T/m] quadrupole gradient (opt.kappa)
    # - B_grad:       &p04    9.72      # [T/m] quadrupole gradient (max necktie border)
    # - B_grad:       &p04    6.87865    # [T/m] quadrupole gradient (~90 deg ph. advance/cell)
    # - B_grad:       &p04    6.87865    # [T/m] quadrupole gradient (tuned with RF-2x20)

    - B_grad_f:     &p10    6.87865   # [T/m] quadrupole gradient focusing QF
    - B_grad_d:     &p09    6.87865   # [T/m] quadrupole gradient focusing QF
#............................................................................................
## ELEMENT definitions
##...........................................................................................
elements:                           ## ELEMENT definitions
    - d1:    &d1            # ID
        - type:     D       # D class
        - length:   0.05  # [m]
    - d2:    &d2            # ID
        - type:     D       # D class
        - length:   0.0125  # [m]
    - qf1:   &qf1           # ID
        - type:     QF      # QF class
        - length:   *p03    # [m] 
        - B':       *p10    # [T/m] quadrupole gradient
    - qd1:   &qd1           # ID
        - type:     QD      # QD class
        - length:   *p02    # [m] length
        - B':       *p09    # [T/m] quadrupole gradient
    - rfg:  &rfg              # ID
        - type:     RFG     # class
        - Ez:       *p05    # [V/m] electric field
        - PhiSync:  *p06    # [deg] synchronous phase
        - fRF:      *p01    # [Hz] frequency
        - gap:      *p07    # [m] length
    - mrk:  &mrk            # ID
        - type:    MRK      # MRK class        
##...........................................................................................
## SEGMENT definitions
##...........................................................................................
segments:                           ## SEGMENT definitions
    - RCAV10:
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
        - *d2
        - *rfg
        - *d2
    - SEG1:
        - *qf1
        - *d1
    - SEG2:
        - *d1
        - *qd1
        - *d1
    - SEG3:
        - *d1
        - *qf1
##...........................................................................................
## LATTICE definition
##...........................................................................................
lattice:                            ## LATTICE definition
    - title: LEBT FODO 28.07.2017 (tuned with RF-2x20)   # description is mandatory. DON't remove or reposition!
    # - [26,SEG1,RCAV10,RCAV10,SEG2,RCAV10,RCAV10,SEG3]
    - [100,SEG1,RCAV10,RCAV10,SEG2,RCAV10,RCAV10,SEG3]
    # - [1,SEG1,RCAV10,RCAV10,SEG2,RCAV10,RCAV10,SEG3]